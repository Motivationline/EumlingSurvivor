[gd_scene format=3 uid="uid://dgr2h5l5eveyh"]

[ext_resource type="PackedScene" uid="uid://cu1ucgco815t4" path="res://game/enemies/base_enemy.tscn" id="1_bghrv"]
[ext_resource type="Script" uid="uid://cd6d7qdolbapn" path="res://state_machine/enemy/wait_for_time_x.gd" id="2_5qkpy"]
[ext_resource type="Script" uid="uid://pxcyq4sjjhtw" path="res://state_machine/enemy/multistate.gd" id="2_rbowq"]
[ext_resource type="Script" uid="uid://cxy0hm7s41xp3" path="res://state_machine/enemy/look_at_player.gd" id="2_rdo5s"]
[ext_resource type="Script" uid="uid://dmskxets4soyo" path="res://state_machine/enemy/move_towards_player.gd" id="2_rwiy8"]
[ext_resource type="Script" uid="uid://cjkeo3brnvde2" path="res://state_machine/enemy/move_forward.gd" id="4_rbowq"]
[ext_resource type="PackedScene" uid="uid://cygf82frkbihh" path="res://assets/characters/enemies/rhino/rhino_prefab.tscn" id="5_rdo5s"]
[ext_resource type="PackedScene" uid="uid://cii4n42sv8t0e" path="res://game/hurtbox/hurtbox.tscn" id="5_rwiy8"]
[ext_resource type="PackedScene" uid="uid://cmvibss2u7woe" path="res://game/hitbox/hitbox.tscn" id="6_0xs35"]
[ext_resource type="Script" uid="uid://c1j50itv0hwo2" path="res://state_machine/enemy/spawn_entities.gd" id="6_n4sta"]
[ext_resource type="Script" uid="uid://1e84fd3xrrff" path="res://game/spawner/entity_spawner.gd" id="7_fs8yq"]
[ext_resource type="PackedScene" uid="uid://bu3a5g7w20saj" path="res://game/enemies/beatle/dummy_attack_visual_enemy.tscn" id="8_n4sta"]
[ext_resource type="PackedScene" uid="uid://cnvxyg3ysg7tf" path="res://game/enemies/beatle/pol_vfx.tscn" id="10_fs8yq"]
[ext_resource type="Script" uid="uid://dc33apjfi7s6v" path="res://strategies/event/enemy/play_sound.gd" id="11_7j3v0"]
[ext_resource type="PackedScene" uid="uid://by87cdyijsrbs" path="res://game/shared/animation trigger component/animation_trigger_component.tscn" id="14_t2e75"]
[ext_resource type="PackedScene" uid="uid://cpbr8uxxklmxm" path="res://game/sound/sfx/sound_presets/enemy_preset.tscn" id="17_5mrum"]
[ext_resource type="AudioStream" uid="uid://cklk8brngu3gh" path="res://assets/characters/enemies/rhino/sounds/buckle_up_1.wav" id="34_xmapy"]
[ext_resource type="AudioStream" uid="uid://cs8p5h7ycx64p" path="res://assets/characters/enemies/rhino/sounds/buckle_up_2.wav" id="35_2b6o8"]
[ext_resource type="AudioStream" uid="uid://bl1ww2jt0hkhg" path="res://assets/characters/enemies/rhino/sounds/buckle_up_3.wav" id="36_gj1s3"]
[ext_resource type="AudioStream" uid="uid://dsi6hejcw43kf" path="res://assets/characters/enemies/rhino/sounds/buckle_up_4.wav" id="37_udmds"]
[ext_resource type="AudioStream" uid="uid://pkwebm35ytpn" path="res://assets/characters/enemies/rhino/sounds/buckle_up_5.wav" id="38_am8so"]
[ext_resource type="AudioStream" uid="uid://div8hvee77hux" path="res://assets/characters/enemies/rhino/sounds/buckle_up_6.wav" id="39_taa2y"]
[ext_resource type="AudioStream" uid="uid://ctohykflw5ryd" path="res://assets/characters/enemies/rhino/sounds/charge_1.wav" id="40_roy04"]
[ext_resource type="AudioStream" uid="uid://dl76posa5g6hh" path="res://assets/characters/enemies/rhino/sounds/charge_2.wav" id="41_d436i"]
[ext_resource type="AudioStream" uid="uid://ctkp8abiml2my" path="res://assets/characters/enemies/rhino/sounds/charge_3.wav" id="42_a7p5m"]
[ext_resource type="AudioStream" uid="uid://b2s1bo8mnj701" path="res://assets/characters/enemies/rhino/sounds/charge_4.wav" id="43_8erk3"]
[ext_resource type="AudioStream" uid="uid://d0nrali8s44em" path="res://assets/characters/enemies/rhino/sounds/charge_5.wav" id="44_qhtni"]
[ext_resource type="AudioStream" uid="uid://d3np7skxwdpkl" path="res://assets/characters/enemies/rhino/sounds/charge_6.wav" id="45_ven6c"]
[ext_resource type="AudioStream" uid="uid://bfxt73l6ob8do" path="res://assets/characters/enemies/rhino/sounds/impact_1.wav" id="46_ql66u"]
[ext_resource type="AudioStream" uid="uid://dxlpe6mippsw2" path="res://assets/characters/enemies/rhino/sounds/impact_2.wav" id="47_xe0qr"]
[ext_resource type="AudioStream" uid="uid://b76mfwoqpm0pc" path="res://assets/characters/enemies/rhino/sounds/impact_3.wav" id="48_qxwjj"]
[ext_resource type="AudioStream" uid="uid://dff5v81844xpy" path="res://assets/characters/enemies/rhino/sounds/impact_4.wav" id="49_4y0gr"]
[ext_resource type="AudioStream" uid="uid://cq56hq5ej8up4" path="res://assets/characters/enemies/rhino/sounds/impact_5.wav" id="50_74ior"]
[ext_resource type="AudioStream" uid="uid://dycy51gbmw5de" path="res://assets/characters/enemies/rhino/sounds/impact_6.wav" id="51_d6f3r"]
[ext_resource type="AudioStream" uid="uid://b2u4i004arlgc" path="res://assets/characters/enemies/rhino/sounds/impact_general.wav" id="52_ejtiv"]
[ext_resource type="AudioStream" uid="uid://o1ait5pfek7h" path="res://assets/characters/enemies/rhino/sounds/death_1.wav" id="53_sa0c1"]
[ext_resource type="AudioStream" uid="uid://bcll7r7r8qmwy" path="res://assets/characters/enemies/rhino/sounds/death_2.wav" id="54_8ql0r"]
[ext_resource type="AudioStream" uid="uid://bsnjaaerxnn11" path="res://assets/characters/enemies/rhino/sounds/death_3.wav" id="55_je6ng"]
[ext_resource type="AudioStream" uid="uid://wg54akhulb01" path="res://assets/characters/enemies/rhino/sounds/death_4.wav" id="56_5gpyg"]
[ext_resource type="AudioStream" uid="uid://bti7ljq1dk2yq" path="res://assets/characters/enemies/rhino/sounds/death_5.wav" id="57_f1jgr"]
[ext_resource type="AudioStream" uid="uid://dwl3pbp4bbs6j" path="res://assets/characters/enemies/rhino/sounds/death_6.wav" id="58_4uioj"]

[sub_resource type="SphereShape3D" id="SphereShape3D_n4sta"]
radius = 0.20846683

[sub_resource type="SphereShape3D" id="SphereShape3D_fs8yq"]

[sub_resource type="SphereShape3D" id="SphereShape3D_t2e75"]
radius = 0.54914546

[sub_resource type="Animation" id="Animation_7j3v0"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Healthbar3D:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(0, 0.7900729, 0.06912398)]
}

[sub_resource type="Animation" id="Animation_jsf3j"]
resource_name = "health_jump"
length = 0.2
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Healthbar3D:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.19999999),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 0,
"values": [Vector3(0, 0.7900729, 0.06912398), Vector3(0, 0.8832582, 0.06912398), Vector3(0, 0.7900729, 0.06912398)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_ujdjm"]
_data = {
&"RESET": SubResource("Animation_7j3v0"),
&"health_jump": SubResource("Animation_jsf3j")
}

[sub_resource type="PrismMesh" id="PrismMesh_431lo"]

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_i1y5j"]
playback_mode = 1
random_pitch = 1.3
random_volume_offset_db = 1.0
streams_count = 6
stream_0/stream = ExtResource("34_xmapy")
stream_1/stream = ExtResource("35_2b6o8")
stream_2/stream = ExtResource("36_gj1s3")
stream_3/stream = ExtResource("37_udmds")
stream_4/stream = ExtResource("38_am8so")
stream_5/stream = ExtResource("39_taa2y")

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_nhgft"]
playback_mode = 1
random_pitch = 1.3
random_volume_offset_db = 1.0
streams_count = 6
stream_0/stream = ExtResource("40_roy04")
stream_1/stream = ExtResource("41_d436i")
stream_2/stream = ExtResource("42_a7p5m")
stream_3/stream = ExtResource("43_8erk3")
stream_4/stream = ExtResource("44_qhtni")
stream_5/stream = ExtResource("45_ven6c")

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_jdxf2"]
playback_mode = 1
random_pitch = 1.3
random_volume_offset_db = 1.0
streams_count = 6
stream_0/stream = ExtResource("46_ql66u")
stream_1/stream = ExtResource("47_xe0qr")
stream_2/stream = ExtResource("48_qxwjj")
stream_3/stream = ExtResource("49_4y0gr")
stream_4/stream = ExtResource("50_74ior")
stream_5/stream = ExtResource("51_d6f3r")

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_q8p6g"]
playback_mode = 1
random_pitch = 1.2
random_volume_offset_db = 1.0
streams_count = 1
stream_0/stream = ExtResource("52_ejtiv")

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_pw7qf"]
streams_count = 6
stream_0/stream = ExtResource("53_sa0c1")
stream_1/stream = ExtResource("54_8ql0r")
stream_2/stream = ExtResource("55_je6ng")
stream_3/stream = ExtResource("56_5gpyg")
stream_4/stream = ExtResource("57_f1jgr")
stream_5/stream = ExtResource("58_4uioj")

[node name="Beatle" unique_id=306559295 node_paths=PackedStringArray("hitbox", "hurtbox", "node_with_animation_tree", "on_death") instance=ExtResource("1_bghrv")]
collision_layer = 80
collision_mask = 65
health = 250.0
hitbox = NodePath("Hitbox")
hurtbox = NodePath("Hurtbox")
node_with_animation_tree = NodePath("Visuals/rhino")
on_death = [NodePath("Eventlisteners/PlaySoundDeathGeneral"), NodePath("Eventlisteners/PlaySoundDeathSpecific")]

[node name="Healthbar3D" parent="." index="0" unique_id=985815578]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.7900729, 0.06912398)

[node name="StateMachine" parent="." index="2" unique_id=2093753398 node_paths=PackedStringArray("initial_state")]
initial_state = NodePath("MoveTowardsPlayerState")

[node name="MoveTowardsPlayerState" type="Node" parent="StateMachine" index="0" unique_id=1355419949 node_paths=PackedStringArray("next_state")]
script = ExtResource("2_rwiy8")
wait_time = 0.0
stop_distance = 2.5
next_state = NodePath("../MultistateState")
metadata/_custom_type_script = "uid://dmskxets4soyo"

[node name="MultistateState" type="Node" parent="StateMachine" index="1" unique_id=1724491819 node_paths=PackedStringArray("states_to_execute", "states_that_need_to_finish", "next_state")]
script = ExtResource("2_rbowq")
states_to_execute = [NodePath("LookAtPlayerState"), NodePath("Wait(Charging)"), NodePath("SpawnEntitiesState")]
states_that_need_to_finish = [NodePath("Wait(Charging)")]
next_state = NodePath("../ChargeAttack")

[node name="LookAtPlayerState" type="Node" parent="StateMachine/MultistateState" index="0" unique_id=1020333136 node_paths=PackedStringArray("next_state")]
script = ExtResource("2_rdo5s")
wait_time = 2.0
speed_override = 70.5
speed_override_active = true
next_state = NodePath(".")
animation_trigger = Dictionary[String, Variant]({
"parameters/OneShot/request": 1,
"parameters/StateMachine/conditions/charge": false,
"parameters/StateMachine/conditions/stunned": false
})
metadata/_custom_type_script = "uid://cxy0hm7s41xp3"

[node name="Wait(Charging)" type="Node" parent="StateMachine/MultistateState" index="1" unique_id=1584608032 node_paths=PackedStringArray("next_state")]
script = ExtResource("2_5qkpy")
wait_time = 2.0
next_state = NodePath("../../ChargeAttack")
metadata/_custom_type_script = "uid://cd6d7qdolbapn"

[node name="SpawnEntitiesState" type="Node" parent="StateMachine/MultistateState" index="2" unique_id=1821245459 node_paths=PackedStringArray("next_state")]
script = ExtResource("6_n4sta")
next_state = NodePath("../LookAtPlayerState")
metadata/_custom_type_script = "uid://c1j50itv0hwo2"

[node name="EntitySpawner" type="Node3D" parent="StateMachine/MultistateState/SpawnEntitiesState" index="0" unique_id=1173161530]
script = ExtResource("7_fs8yq")
ignore_relative_rotation = true
entity_to_spawn = ExtResource("8_n4sta")
metadata/_custom_type_script = "uid://1e84fd3xrrff"

[node name="ChargeAttack" type="Node" parent="StateMachine" index="2" unique_id=1720604720 node_paths=PackedStringArray("next_state")]
script = ExtResource("4_rbowq")
max_distance = 20.0
max_time = 1.0
speed_override = 5.0
speed_override_active = true
next_state = NodePath("../MultistateState2")
animation_trigger = Dictionary[String, Variant]({
"parameters/StateMachine/conditions/charge": true
})
metadata/_custom_type_script = "uid://cjkeo3brnvde2"

[node name="MultistateState2" type="Node" parent="StateMachine" index="3" unique_id=769187614 node_paths=PackedStringArray("states_to_execute", "states_that_need_to_finish", "next_state")]
script = ExtResource("2_rbowq")
states_to_execute = [NodePath("SpawnEntitiesState"), NodePath("Wait(Stunned)")]
states_that_need_to_finish = [NodePath("Wait(Stunned)")]
next_state = NodePath("../MoveTowardsPlayerState")

[node name="Wait(Stunned)" type="Node" parent="StateMachine/MultistateState2" index="0" unique_id=428388572 node_paths=PackedStringArray("next_state")]
script = ExtResource("2_5qkpy")
wait_time = 2.0
next_state = NodePath("../../MoveTowardsPlayerState")
animation_trigger = Dictionary[String, Variant]({
"parameters/StateMachine/conditions/stunned": true
})
metadata/_custom_type_script = "uid://cd6d7qdolbapn"

[node name="SpawnEntitiesState" type="Node" parent="StateMachine/MultistateState2" index="1" unique_id=437360592 node_paths=PackedStringArray("next_state")]
script = ExtResource("6_n4sta")
next_state = NodePath("../../MultistateState/LookAtPlayerState")
metadata/_custom_type_script = "uid://c1j50itv0hwo2"

[node name="EntitySpawner" type="Node3D" parent="StateMachine/MultistateState2/SpawnEntitiesState" index="0" unique_id=814058828]
transform = Transform3D(1, 0, 0, 0, 0.7890626, 0.61431277, 0, -0.61431277, 0.7890626, 0, 0.40301532, -0.3561021)
script = ExtResource("7_fs8yq")
entity_to_spawn = ExtResource("10_fs8yq")
metadata/_custom_type_script = "uid://1e84fd3xrrff"

[node name="PlaySoundDeathSpecific" type="Node" parent="Eventlisteners" parent_id_path=PackedInt32Array(1073347732) index="0" unique_id=416844537 node_paths=PackedStringArray("sound_manager")]
script = ExtResource("11_7j3v0")
sound_manager = NodePath("../../SoundEffectManager")
sound_to_play = "Death"
needs_to_be_persistent = true

[node name="CollisionShape3D" type="CollisionShape3D" parent="." index="4" unique_id=2139522427]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.20420316, 0)
shape = SubResource("SphereShape3D_n4sta")

[node name="Hurtbox" parent="." index="5" unique_id=85413306 instance=ExtResource("5_rwiy8")]
collision_layer = 64
collision_mask = 4
attached_to = 7
can_be_hit_by = 3

[node name="CollisionShape3D" type="CollisionShape3D" parent="Hurtbox" index="0" unique_id=1803152819]
shape = SubResource("SphereShape3D_fs8yq")

[node name="Hitbox" parent="." index="6" unique_id=504595573 instance=ExtResource("6_0xs35")]
collision_layer = 32
collision_mask = 8
damage = 75.0
attached_to = 6
can_hit = 4

[node name="CollisionShape3D" type="CollisionShape3D" parent="Hitbox" index="0" unique_id=2134337856]
shape = SubResource("SphereShape3D_t2e75")

[node name="AnimationTriggerComponent" parent="." index="7" unique_id=1597452394 node_paths=PackedStringArray("node_to_connect", "animation_player") instance=ExtResource("14_t2e75")]
node_to_connect = NodePath("../Hurtbox")
signal_to_connect = "hurt_by"
animation_player = NodePath("../AnimationPlayer")
animation_to_play = "health_jump"

[node name="AnimationPlayer" type="AnimationPlayer" parent="." index="8" unique_id=1575891136]
libraries/ = SubResource("AnimationLibrary_ujdjm")

[node name="MeshInstance3D" type="MeshInstance3D" parent="Visuals" parent_id_path=PackedInt32Array(110309936) index="0" unique_id=133450068]
transform = Transform3D(0.4514425, 0, 0, 0, -4.2719705e-08, 0.5626625, 0, -0.9773129, -2.4594758e-08, 0, 0.2828154, -0.07334371)
visible = false
mesh = SubResource("PrismMesh_431lo")

[node name="rhino" parent="Visuals" parent_id_path=PackedInt32Array(110309936) index="1" unique_id=1358389603 instance=ExtResource("5_rdo5s")]
transform = Transform3D(1.2, 0, 0, 0, 1.2, 0, 0, 0, 1.2, 0, 0, -0.123390555)

[node name="BuckleUp" parent="SoundEffectManager" parent_id_path=PackedInt32Array(212820490) index="0" unique_id=756819873 instance=ExtResource("17_5mrum")]
stream = SubResource("AudioStreamRandomizer_i1y5j")

[node name="Charge" parent="SoundEffectManager" parent_id_path=PackedInt32Array(212820490) index="1" unique_id=1419157624 instance=ExtResource("17_5mrum")]
stream = SubResource("AudioStreamRandomizer_nhgft")

[node name="Impact" parent="SoundEffectManager" parent_id_path=PackedInt32Array(212820490) index="2" unique_id=1695076364 instance=ExtResource("17_5mrum")]
stream = SubResource("AudioStreamRandomizer_jdxf2")

[node name="ImpactGeneral" parent="SoundEffectManager" parent_id_path=PackedInt32Array(212820490) index="3" unique_id=2086640730 instance=ExtResource("17_5mrum")]
stream = SubResource("AudioStreamRandomizer_q8p6g")

[node name="Death" parent="SoundEffectManager" parent_id_path=PackedInt32Array(212820490) index="4" unique_id=1259281917 instance=ExtResource("17_5mrum")]
stream = SubResource("AudioStreamRandomizer_pw7qf")

[connection signal="play_sound" from="Visuals/rhino" to="SoundEffectManager" method="play_sound"]
