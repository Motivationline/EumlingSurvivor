[gd_scene format=3 uid="uid://d2d31toherh53"]

[ext_resource type="PackedScene" uid="uid://dg5ap3nmd46eb" path="res://game/projectiles/base_projectile.tscn" id="1_ehkq2"]
[ext_resource type="PackedScene" uid="uid://cxdkd7r0krykq" path="res://game/enemies/6-volcano/magma_toad/projectile/magma_ball_projectile_visual.tscn" id="2_ib3xs"]
[ext_resource type="Script" uid="uid://l8142vs0gken" path="res://strategies/projectile_target/universal.gd" id="3_ma2mw"]
[ext_resource type="Script" uid="uid://ciibuj5lu0oho" path="res://strategies/projectile_movement/artillery_move_to_target.gd" id="4_54631"]
[ext_resource type="Script" uid="uid://nxmo7fqigkr1" path="res://strategies/event/set_targets.gd" id="5_54631"]
[ext_resource type="Script" uid="uid://cpx1eq3gu268a" path="res://strategies/event/spawn_entities.gd" id="6_by40c"]
[ext_resource type="Script" uid="uid://coqjh4l5f0121" path="res://strategies/event/remove.gd" id="6_vrxug"]
[ext_resource type="PackedScene" uid="uid://cmvibss2u7woe" path="res://game/hitbox/hitbox.tscn" id="7_54631"]
[ext_resource type="Script" uid="uid://1e84fd3xrrff" path="res://game/spawner/entity_spawner.gd" id="7_m8640"]
[ext_resource type="PackedScene" uid="uid://db8m7lns2hnlo" path="res://game/aoes/explosion/standard_explosion.tscn" id="8_by40c"]

[sub_resource type="SphereShape3D" id="SphereShape3D_vrxug"]
radius = 0.09788437

[sub_resource type="SphereShape3D" id="SphereShape3D_4kao4"]
radius = 0.0991429

[sub_resource type="SphereMesh" id="SphereMesh_54631"]
radius = 0.15
height = 0.3
radial_segments = 8
rings = 4

[node name="Projectile" unique_id=1865303972 node_paths=PackedStringArray("hit_box", "movement", "targeting", "on_world_collision", "on_created") instance=ExtResource("1_ehkq2")]
max_distance = 100.0
lifetime = 10.0
hit_box = NodePath("Hitbox")
movement = [NodePath("MovementStrategies/ArtilleryToTargetProjectileMovementStrategy")]
targeting = [NodePath("MovementStrategies/UniversalTargetingProjectileTargetStrategy")]
on_world_collision = [NodePath("EventStrategies/OnWorldCollision/SpawnEntitiesEventStrategy"), NodePath("EventStrategies/OnWorldCollision/RemoveEventStrategy")]
on_created = [NodePath("MovementStrategies/SetTargetsEventStrategy")]

[node name="UniversalTargetingProjectileTargetStrategy" type="Node" parent="MovementStrategies" index="0" unique_id=619591397]
script = ExtResource("3_ma2mw")
target_property = 2
target_sorter = 3
max_radius = 100.0
max_targets = 1
metadata/_custom_type_script = "uid://l8142vs0gken"

[node name="ArtilleryToTargetProjectileMovementStrategy" type="Node" parent="MovementStrategies" index="1" unique_id=1875998004]
script = ExtResource("4_54631")
rotation_speed = 0.0
velocity_change_rate = 3.0
speed_amp = 5.0
arc_factor = 4.0
prediction_factor = 0.1
metadata/_custom_type_script = "uid://ciibuj5lu0oho"

[node name="SetTargetsEventStrategy" type="Node" parent="MovementStrategies" index="2" unique_id=155478377 node_paths=PackedStringArray("targeting_strats")]
script = ExtResource("5_54631")
targeting_strats = [NodePath("../UniversalTargetingProjectileTargetStrategy")]
metadata/_custom_type_script = "uid://nxmo7fqigkr1"

[node name="RemoveEventStrategy" type="Node" parent="EventStrategies/OnWorldCollision" index="0" unique_id=743689288]
script = ExtResource("6_vrxug")
metadata/_custom_type_script = "uid://coqjh4l5f0121"

[node name="SpawnEntitiesEventStrategy" type="Node" parent="EventStrategies/OnWorldCollision" index="1" unique_id=715170125]
script = ExtResource("6_by40c")
metadata/_custom_type_script = "uid://cpx1eq3gu268a"

[node name="EntitySpawner" type="Node3D" parent="EventStrategies/OnWorldCollision/SpawnEntitiesEventStrategy" index="0" unique_id=2059347249]
script = ExtResource("7_m8640")
entity_to_spawn = ExtResource("8_by40c")
metadata/_custom_type_script = "uid://1e84fd3xrrff"

[node name="Magma_Ball" parent="." index="2" unique_id=153719346 instance=ExtResource("2_ib3xs")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.38858503, 0)

[node name="Hitbox" parent="." index="3" unique_id=1015019145 instance=ExtResource("7_54631")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.38858503, 0)
collision_layer = 43
collision_mask = 11
individual_hit_limit = 1
attached_to = 6
can_hit = 4

[node name="CollisionShape3D" type="CollisionShape3D" parent="Hitbox" index="0" unique_id=1730789186]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.009144962, 0)
shape = SubResource("SphereShape3D_vrxug")

[node name="CollisionShape3D" type="CollisionShape3D" parent="." index="4" unique_id=222403771]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.39123645, 0)
shape = SubResource("SphereShape3D_4kao4")

[node name="ShadowCast" type="MeshInstance3D" parent="." index="5" unique_id=571648281]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.40234306, 0)
cast_shadow = 3
mesh = SubResource("SphereMesh_54631")
