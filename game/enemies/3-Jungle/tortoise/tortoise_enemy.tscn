[gd_scene format=3 uid="uid://drtoi8fygioae"]

[ext_resource type="PackedScene" uid="uid://cu1ucgco815t4" path="res://game/enemies/base_enemy.tscn" id="1_5rk5k"]
[ext_resource type="Script" uid="uid://dgi4gidx4vpsn" path="res://state_machine/enemy/move_random_nav_mesh.gd" id="2_eux68"]
[ext_resource type="PackedScene" uid="uid://cgtlnuch0nmwm" path="res://assets/characters/enemies/tortoise/tortoise_prefab.tscn" id="2_s8eqa"]
[ext_resource type="PackedScene" uid="uid://cmvibss2u7woe" path="res://game/hitbox/hitbox.tscn" id="4_c3oc6"]
[ext_resource type="Script" uid="uid://c1j50itv0hwo2" path="res://state_machine/enemy/spawn_entities.gd" id="4_eq0kn"]
[ext_resource type="PackedScene" uid="uid://cii4n42sv8t0e" path="res://game/hurtbox/hurtbox.tscn" id="5_4kafm"]
[ext_resource type="PackedScene" uid="uid://c03op2rrwafaq" path="res://game/enemies/3-jungle/tortoise/tortoise_projectile.tscn" id="5_eux68"]
[ext_resource type="Script" uid="uid://1e84fd3xrrff" path="res://game/spawner/entity_spawner.gd" id="5_lwqy1"]
[ext_resource type="Script" uid="uid://pv70hoylokg6" path="res://game/spawner/strategies/rotation/circle.gd" id="7_8vp05"]
[ext_resource type="Script" uid="uid://dc33apjfi7s6v" path="res://strategies/event/enemy/play_sound.gd" id="9_l76kt"]
[ext_resource type="Script" uid="uid://cpx1eq3gu268a" path="res://strategies/event/spawn_entities.gd" id="10_84v5a"]
[ext_resource type="Script" uid="uid://dpcp1l71hgqcc" path="res://game/spawner/strategies/rotation/random_rotation.gd" id="11_ql6kd"]
[ext_resource type="Script" uid="uid://dp24h8qvxnoq7" path="res://strategies/event/enemy/play_animation.gd" id="12_scaj3"]
[ext_resource type="Shader" uid="uid://chiexwbpmjuuj" path="res://assets/vfx/projectile_realistic/shader_fireheader.tres" id="13_ql6kd"]
[ext_resource type="AudioStream" uid="uid://cq74ndddkno7h" path="res://assets/characters/enemies/tortoise/sounds/shake_1.wav" id="16_0jpdq"]
[ext_resource type="PackedScene" uid="uid://cpbr8uxxklmxm" path="res://game/sound/sfx/sound_presets/enemy_preset.tscn" id="16_gjal0"]
[ext_resource type="AudioStream" uid="uid://dyx8o67l68hd0" path="res://assets/characters/enemies/tortoise/sounds/shake_2.wav" id="17_mc1rk"]
[ext_resource type="AudioStream" uid="uid://dihxorvypi2is" path="res://assets/characters/enemies/tortoise/sounds/shake_3.wav" id="18_7y1eb"]
[ext_resource type="AudioStream" uid="uid://8lj10depf48g" path="res://assets/characters/enemies/tortoise/sounds/shake_4.wav" id="19_r5gtk"]
[ext_resource type="AudioStream" uid="uid://bx2l13samx42h" path="res://assets/characters/enemies/tortoise/sounds/shake_5.wav" id="20_r6bkk"]
[ext_resource type="AudioStream" uid="uid://dwnb2ysso6eoy" path="res://assets/characters/enemies/tortoise/sounds/shake_6.wav" id="21_r133h"]
[ext_resource type="AudioStream" uid="uid://br8cvyuvaedbt" path="res://assets/characters/enemies/tortoise/sounds/death_1.wav" id="22_gjal0"]
[ext_resource type="AudioStream" uid="uid://4qftj0c54m3m" path="res://assets/characters/enemies/tortoise/sounds/death_2.wav" id="23_yu1vo"]
[ext_resource type="AudioStream" uid="uid://b6kiqmsiue8d5" path="res://assets/characters/enemies/tortoise/sounds/death_3.wav" id="24_i6ytl"]
[ext_resource type="AudioStream" uid="uid://brp1odc2gm6u4" path="res://assets/characters/enemies/tortoise/sounds/death_4.wav" id="25_62ngo"]
[ext_resource type="AudioStream" uid="uid://dqbf5uo5knv04" path="res://assets/characters/enemies/tortoise/sounds/death_5.wav" id="26_3836p"]
[ext_resource type="AudioStream" uid="uid://bblxqdptr1fvr" path="res://assets/characters/enemies/tortoise/sounds/death_6.wav" id="27_qmjli"]

[sub_resource type="Resource" id="Resource_84v5a"]
script = ExtResource("7_8vp05")
metadata/_custom_type_script = "uid://pv70hoylokg6"

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_4kafm"]
radius = 0.439081
height = 0.955451

[sub_resource type="SphereShape3D" id="SphereShape3D_a57xe"]
radius = 0.39281

[sub_resource type="SphereShape3D" id="SphereShape3D_fgitk"]
radius = 0.437599

[sub_resource type="Resource" id="Resource_scaj3"]
script = ExtResource("11_ql6kd")
max_negative = -180.0
max_positive = 180.0
metadata/_custom_type_script = "uid://dpcp1l71hgqcc"

[sub_resource type="ShaderMaterial" id="ShaderMaterial_abuar"]
resource_local_to_scene = true
render_priority = 0
shader = ExtResource("13_ql6kd")
shader_parameter/ball_color = Color(1.6978991, 0, 0, 1)
shader_parameter/frensel_power = -1.36
shader_parameter/visibility = 0.0

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_dchbn"]
streams_count = 6
stream_0/stream = ExtResource("16_0jpdq")
stream_1/stream = ExtResource("17_mc1rk")
stream_2/stream = ExtResource("18_7y1eb")
stream_3/stream = ExtResource("19_r5gtk")
stream_4/stream = ExtResource("20_r6bkk")
stream_5/stream = ExtResource("21_r133h")

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_mr30t"]
streams_count = 6
stream_0/stream = ExtResource("22_gjal0")
stream_1/stream = ExtResource("23_yu1vo")
stream_2/stream = ExtResource("24_i6ytl")
stream_3/stream = ExtResource("25_62ngo")
stream_4/stream = ExtResource("26_3836p")
stream_5/stream = ExtResource("27_qmjli")

[node name="TortoiseEnemy" unique_id=1961314702 node_paths=PackedStringArray("hitbox", "hurtbox", "node_with_animation_tree", "on_death", "on_hurt") instance=ExtResource("1_5rk5k")]
collision_layer = 64
collision_mask = 65
health = 320.0
speed = 0.4
hitbox = NodePath("Hitbox")
hurtbox = NodePath("Hurtbox")
node_with_animation_tree = NodePath("Visuals/tortoise")
on_death = [NodePath("Eventlisteners/PlaySoundDeathSpecific"), NodePath("Eventlisteners/PlaySoundDeathGeneral")]
on_hurt = [NodePath("Eventlisteners/PlayAnimationEventStrategy"), NodePath("Eventlisteners/SpawnEntitiesEventStrategy"), NodePath("Eventlisteners/PlaySoundHitGeneral")]

[node name="Healthbar3D" parent="." index="0" unique_id=985815578]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.919, 0)

[node name="StateMachine" parent="." index="2" unique_id=2093753398 node_paths=PackedStringArray("initial_state")]
initial_state = NodePath("MoveRandomOnNavMeshState")

[node name="MoveRandomOnNavMeshState" type="Node" parent="StateMachine" index="0" unique_id=2117470740 node_paths=PackedStringArray("next_state")]
script = ExtResource("2_eux68")
wait_time = 0.0
max_distance = 2.5
next_state = NodePath("../SpawnEntitiesState")
animation_trigger = Dictionary[String, Variant]({
"parameters/Transition/transition_request": "walk"
})
metadata/_custom_type_script = "uid://dgi4gidx4vpsn"

[node name="SpawnEntitiesState" type="Node" parent="StateMachine" index="1" unique_id=1031693980 node_paths=PackedStringArray("next_state")]
script = ExtResource("4_eq0kn")
start_delay = 0.5
end_delay = 0.8
next_state = NodePath("../MoveRandomOnNavMeshState")
animation_trigger = Dictionary[String, Variant]({
"parameters/shake/request": 1
})
metadata/_custom_type_script = "uid://c1j50itv0hwo2"

[node name="EntitySpawner" type="Node3D" parent="StateMachine/SpawnEntitiesState" index="0" unique_id=349898979]
script = ExtResource("5_lwqy1")
entity_to_spawn = ExtResource("5_eux68")
amount_of_spawns = 5
time_between_entities = 0.25
offset_distance = 0.2
rotation_strategy = SubResource("Resource_84v5a")
time_between_bursts = 0.2
amount_of_bursts = 2
metadata/_custom_type_script = "uid://1e84fd3xrrff"

[node name="Hitbox" parent="." index="3" unique_id=1203355617 instance=ExtResource("4_c3oc6")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.35191, 0)
collision_layer = 32
collision_mask = 8
damage = 50.0
attached_to = 6
can_hit = 4

[node name="CollisionShape3D" type="CollisionShape3D" parent="Hitbox" index="0" unique_id=512498433]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.066589, 0)
shape = SubResource("CapsuleShape3D_4kafm")

[node name="Hurtbox" parent="." index="4" unique_id=1188508080 instance=ExtResource("5_4kafm")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.334121, 0)
collision_layer = 64
collision_mask = 4
attached_to = 7
can_be_hit_by = 3

[node name="CollisionShape3D" type="CollisionShape3D" parent="Hurtbox" index="0" unique_id=66065392]
shape = SubResource("SphereShape3D_a57xe")
debug_color = Color(0.883413, 0.262783, 0.530975, 0.42)

[node name="CollisionShape3D" type="CollisionShape3D" parent="." index="5" unique_id=874821720]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.388744, 0)
shape = SubResource("SphereShape3D_fgitk")

[node name="PlaySoundDeathSpecific" type="Node" parent="Eventlisteners" parent_id_path=PackedInt32Array(1073347732) index="0" unique_id=1646321378]
script = ExtResource("9_l76kt")
sound_to_play = "Death"
needs_to_be_persistent = true

[node name="SpawnEntitiesEventStrategy" type="Node" parent="Eventlisteners" parent_id_path=PackedInt32Array(1073347732) index="1" unique_id=728218215]
script = ExtResource("10_84v5a")
metadata/_custom_type_script = "uid://cpx1eq3gu268a"

[node name="EntitySpawner" type="Node3D" parent="Eventlisteners/SpawnEntitiesEventStrategy" index="0" unique_id=1658945836]
script = ExtResource("5_lwqy1")
entity_to_spawn = ExtResource("5_eux68")
amount_of_spawns = 15
offset_distance = 0.2
rotation_strategy = SubResource("Resource_scaj3")
time_between_bursts = 0.2
metadata/_custom_type_script = "uid://1e84fd3xrrff"

[node name="PlayAnimationEventStrategy" type="Node" parent="Eventlisteners" parent_id_path=PackedInt32Array(1073347732) index="2" unique_id=861193701]
script = ExtResource("12_scaj3")
animation_trigger = Dictionary[String, Variant]({
"parameters/hurt/request": 1
})
metadata/_custom_type_script = "uid://dp24h8qvxnoq7"

[node name="tortoise" parent="Visuals" parent_id_path=PackedInt32Array(110309936) index="0" unique_id=1904037027 instance=ExtResource("2_s8eqa")]

[node name="Skeleton3D" parent="Visuals/tortoise/Armature_Tortoise" parent_id_path=PackedInt32Array(1904037027, 118004176) index="0" unique_id=1328783715]
bones/0/position = Vector3(0, 0.100923404, 4.440892e-16)
bones/1/position = Vector3(0, 0.24905768, -2.2351742e-08)
bones/2/position = Vector3(0.13752593, 0.26851314, -0.3115102)
bones/2/rotation = Quaternion(-0.6523285, 0.0019203993, 0.0019202246, 0.75793165)
bones/3/position = Vector3(-3.67249e-05, 0.29013032, -0.45804057)
bones/4/position = Vector3(0.1595301, 0.32271412, -0.42650935)
bones/5/position = Vector3(0.29653853, 0.32549462, -0.33225086)
bones/6/position = Vector3(3.4786796e-16, 0.24773347, 0.2928202)
bones/7/position = Vector3(5.957764e-15, 0.23047128, 0.37576702)
bones/8/position = Vector3(6.519827e-15, 0.2132091, 0.45871383)
bones/9/position = Vector3(0.2847773, 0.25992167, -0.22281702)
bones/9/rotation = Quaternion(0.8999953, 0.07915063, 0.37073144, -0.21517862)
bones/10/position = Vector3(0.32659307, 0.13596594, -0.26831448)
bones/10/rotation = Quaternion(-0.32261246, 0.37478787, 0.856811, 0.1460487)
bones/13/position = Vector3(0.27231175, 0.25992167, 0.22873244)
bones/13/rotation = Quaternion(0.9179217, 0.06481603, 0.3237566, -0.22000064)
bones/14/position = Vector3(0.30851063, 0.13597558, 0.17862654)
bones/14/rotation = Quaternion(-0.25667727, 0.3846261, 0.87899625, 0.11638444)
bones/17/position = Vector3(-0.13752593, 0.26851314, -0.3115102)
bones/17/rotation = Quaternion(-0.6523285, -0.0019203933, -0.0019202316, 0.75793165)
bones/18/position = Vector3(-0.1595301, 0.32271412, -0.42650935)
bones/19/position = Vector3(-0.29653853, 0.32549462, -0.33225086)
bones/20/position = Vector3(0, 0.67010313, -2.2351742e-08)
bones/21/position = Vector3(0.013346332, 0.67680407, -0.10696809)
bones/21/rotation = Quaternion(-0.66650164, 0.0040000193, 0.003576225, 0.7454843)
bones/22/position = Vector3(0.01250859, 0.6848256, -0.18503092)
bones/22/rotation = Quaternion(-0.7744957, -0.009623272, -0.010749367, 0.6324146)
bones/23/position = Vector3(0.01543479, 0.6653802, -0.285582)
bones/23/rotation = Quaternion(0.92742383, -0.014246534, -0.03276924, -0.37230137)
bones/24/position = Vector3(0.010454722, 0.5940041, -0.35316446)
bones/24/rotation = Quaternion(0.9795731, -0.010779911, -0.046843994, -0.19525896)
bones/25/position = Vector3(0.00549151, 0.47709203, -0.4011587)
bones/25/rotation = Quaternion(0.99072546, -0.01241923, -0.10243328, -0.08841021)
bones/26/position = Vector3(0.10350018, 0.6741259, -0.030826997)
bones/26/rotation = Quaternion(-0.5793564, -0.36856914, -0.32951987, 0.64801216)
bones/27/position = Vector3(0.1705985, 0.68214744, -0.07073087)
bones/27/rotation = Quaternion(-0.6657919, -0.32394692, -0.39582857, 0.5432304)
bones/28/position = Vector3(0.25903672, 0.662702, -0.11866602)
bones/28/rotation = Quaternion(0.8199951, 0.1735099, 0.43441215, -0.32983103)
bones/29/position = Vector3(0.3149912, 0.59132594, -0.15689267)
bones/29/rotation = Quaternion(0.87224823, 0.08810281, 0.44826415, -0.17458579)
bones/30/position = Vector3(0.35401183, 0.4744139, -0.18527356)
bones/30/rotation = Quaternion(0.9096546, 0.033359088, 0.4056574, -0.08281175)
bones/31/position = Vector3(0.05740403, 0.6653608, 0.08162282)
bones/31/rotation = Quaternion(0.3103244, 0.6597615, 0.58986104, -0.34709886)
bones/32/position = Vector3(0.12173942, 0.67338234, 0.12584347)
bones/32/rotation = Quaternion(0.34737846, 0.56569225, 0.6923058, -0.28290135)
bones/32/scale = Vector3(1, 1, 1.0000001)
bones/33/position = Vector3(0.20230447, 0.6539369, 0.18607941)
bones/33/rotation = Quaternion(0.45645648, 0.32394615, 0.80793154, -0.18426383)
bones/34/position = Vector3(0.26045, 0.58256084, 0.22088285)
bones/34/rotation = Quaternion(0.49299908, 0.16832134, 0.8477675, -0.09955)
bones/35/position = Vector3(0.30256316, 0.46564874, 0.24443197)
bones/35/rotation = Quaternion(0.5474701, 0.072850406, 0.83203673, -0.051810145)
bones/36/position = Vector3(-0.036318526, 0.6553079, 0.05382657)
bones/36/rotation = Quaternion(-0.20209248, 0.7506582, 0.56993055, 0.26617697)
bones/37/position = Vector3(-0.083989896, 0.67567503, 0.11259479)
bones/37/rotation = Quaternion(-0.254402, 0.64767003, 0.6750905, 0.24506333)
bones/38/position = Vector3(-0.15178521, 0.67255086, 0.18956333)
bones/38/rotation = Quaternion(-0.27909008, 0.4236085, 0.8506521, 0.13804208)
bones/39/position = Vector3(-0.19796652, 0.61285514, 0.2526307)
bones/39/rotation = Quaternion(-0.29661193, 0.26003322, 0.91513276, 0.08328365)
bones/40/position = Vector3(-0.23656477, 0.50508124, 0.3063151)
bones/40/rotation = Quaternion(-0.28313217, 0.16084827, 0.9443535, 0.046482388)
bones/41/position = Vector3(-0.051357567, 0.6632849, -0.031914502)
bones/41/rotation = Quaternion(-0.5263545, 0.4372386, 0.36455557, 0.63156354)
bones/42/position = Vector3(-0.12369174, 0.6766935, -0.059100337)
bones/42/rotation = Quaternion(-0.62737674, 0.36255756, 0.414521, 0.550566)
bones/43/position = Vector3(-0.21725333, 0.66433805, -0.09916397)
bones/43/rotation = Quaternion(0.74172586, -0.23651324, -0.53525484, -0.3277294)
bones/44/position = Vector3(-0.28600502, 0.5977533, -0.121991314)
bones/44/rotation = Quaternion(0.7885901, -0.13373765, -0.57077575, -0.1856205)
bones/45/position = Vector3(-0.33920893, 0.48438856, -0.13961652)
bones/45/rotation = Quaternion(0.7900271, -0.074244134, -0.60080576, -0.09683781)
bones/46/position = Vector3(-0.28477737, 0.25992167, -0.22281699)
bones/46/rotation = Quaternion(0.89999545, -0.07915035, -0.3707315, -0.21517809)
bones/47/position = Vector3(-0.326593, 0.13596588, -0.26831436)
bones/47/rotation = Quaternion(0.3226126, 0.37478748, 0.8568111, -0.14604871)
bones/50/position = Vector3(-0.27231175, 0.25992167, 0.22873244)
bones/50/rotation = Quaternion(0.9179218, -0.06481596, -0.3237566, -0.22000025)
bones/51/position = Vector3(-0.30851054, 0.13597552, 0.17862655)
bones/51/rotation = Quaternion(0.2566774, 0.38462612, 0.8789962, -0.11638446)
bones/54/position = Vector3(0.0030766092, 0.24910074, -0.37708822)
bones/55/position = Vector3(0.030316474, 0.2536891, -0.39280522)
bones/56/position = Vector3(0.06656808, 0.24673635, -0.4118512)
bones/57/position = Vector3(0.090218365, 0.21902859, -0.4274844)
bones/58/position = Vector3(0.10751601, 0.17264146, -0.4395425)
bones/59/position = Vector3(0.36522165, 0.2509278, -0.05871908)
bones/60/position = Vector3(0.38157618, 0.27134407, -0.08607304)
bones/61/position = Vector3(0.4084351, 0.28399286, -0.12563846)
bones/62/position = Vector3(0.43116894, 0.26777345, -0.16370119)
bones/63/position = Vector3(0.45542556, 0.22772974, -0.2023065)
bones/64/position = Vector3(0.33915424, 0.23065113, -0.046248212)
bones/65/position = Vector3(0.37264362, 0.2501761, -0.020950211)
bones/66/position = Vector3(0.41796654, 0.2578168, 0.018386105)
bones/67/position = Vector3(0.45766383, 0.23092759, 0.05055265)
bones/68/position = Vector3(0.49408695, 0.1750197, 0.083040774)
bones/69/position = Vector3(0.30403218, 0.26217055, -0.04196698)
bones/70/position = Vector3(0.3610152, 0.2535348, -0.044963382)
bones/71/position = Vector3(0.42860165, 0.22006437, -0.044173658)
bones/72/position = Vector3(0.46309105, 0.15689862, -0.0456551)
bones/73/position = Vector3(0.47518352, 0.06517738, -0.044188045)
bones/74/position = Vector3(-0.36522165, 0.2509278, -0.05871905)
bones/75/position = Vector3(-0.38157618, 0.27134407, -0.08607301)
bones/76/position = Vector3(-0.4084351, 0.28399286, -0.12563843)
bones/77/position = Vector3(-0.43116894, 0.26777345, -0.16370116)
bones/78/position = Vector3(-0.45542556, 0.22772974, -0.20230645)
bones/79/position = Vector3(-0.33915424, 0.23065113, -0.046248216)
bones/80/position = Vector3(-0.3726436, 0.25017607, -0.020950237)
bones/81/position = Vector3(-0.4179665, 0.25781676, 0.018386079)
bones/82/position = Vector3(-0.4576638, 0.23092756, 0.050552636)
bones/83/position = Vector3(-0.49408692, 0.17501965, 0.083040774)
bones/84/position = Vector3(-0.30403218, 0.26217055, -0.04196698)
bones/85/position = Vector3(-0.3610152, 0.2535348, -0.044963382)
bones/86/position = Vector3(-0.42860165, 0.22006437, -0.044173658)
bones/87/position = Vector3(-0.46309105, 0.15689862, -0.0456551)
bones/88/position = Vector3(-0.4751835, 0.065177366, -0.044188045)
bones/89/position = Vector3(-0.0030766136, 0.24910074, -0.37708822)
bones/90/position = Vector3(-0.03031648, 0.2536891, -0.39280522)
bones/91/position = Vector3(-0.06656809, 0.24673635, -0.4118512)
bones/92/position = Vector3(-0.090218395, 0.21902859, -0.4274844)
bones/93/position = Vector3(-0.10751605, 0.17264144, -0.4395425)

[node name="Tortoise" parent="Visuals/tortoise/Armature_Tortoise/Skeleton3D" index="0" unique_id=1885567142]
material_overlay = SubResource("ShaderMaterial_abuar")

[node name="Shake" parent="SoundEffectManager" parent_id_path=PackedInt32Array(212820490) index="2" unique_id=610131262 instance=ExtResource("16_gjal0")]
stream = SubResource("AudioStreamRandomizer_dchbn")

[node name="Death" parent="SoundEffectManager" parent_id_path=PackedInt32Array(212820490) index="3" unique_id=311950094 instance=ExtResource("16_gjal0")]
stream = SubResource("AudioStreamRandomizer_mr30t")

[connection signal="play_sound" from="Visuals/tortoise" to="SoundEffectManager" method="play_sound"]

[editable path="Visuals/tortoise"]
