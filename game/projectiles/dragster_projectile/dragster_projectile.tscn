[gd_scene load_steps=14 format=3 uid="uid://bhfncjfyvm7a2"]

[ext_resource type="PackedScene" uid="uid://dg5ap3nmd46eb" path="res://game/projectiles/base_projectile.tscn" id="1_r6l80"]
[ext_resource type="Script" uid="uid://c1k2fcc6tpf3l" path="res://strategies/projectile_movement/speed.gd" id="2_w3pkm"]
[ext_resource type="PackedScene" uid="uid://cmvibss2u7woe" path="res://game/hitbox/hitbox.tscn" id="4_1o4ia"]
[ext_resource type="Script" uid="uid://cpx1eq3gu268a" path="res://strategies/event/spawn_entities.gd" id="4_4t18b"]
[ext_resource type="Script" uid="uid://1e84fd3xrrff" path="res://game/spawner/entity_spawner.gd" id="5_as7w8"]
[ext_resource type="PackedScene" uid="uid://bov1hcmo0on0h" path="res://game/vfx/firehit/fire_hit.tscn" id="6_aco2d"]

[sub_resource type="Curve" id="Curve_vnuuy"]
_limits = [0.0, 8.0, 0.0, 1.0]
_data = [Vector2(0, 1.06343), 0.0, 0.0, 0, 0, Vector2(1, 8), -0.721896, 0.0, 0, 0]
point_count = 2

[sub_resource type="CylinderMesh" id="CylinderMesh_1o4ia"]
top_radius = 0.25
bottom_radius = 0.25
height = 0.1
radial_segments = 5

[sub_resource type="Animation" id="Animation_xs5fn"]
resource_name = "rotate"
length = 0.3
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("MeshInstance3D:rotation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.3),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector3(6.28319, 0, 1.65806), Vector3(0, 0, 1.5708)]
}

[sub_resource type="Animation" id="Animation_fhhkv"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("MeshInstance3D:rotation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(0, 0, 0)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_4t18b"]
_data = {
&"RESET": SubResource("Animation_fhhkv"),
&"rotate": SubResource("Animation_xs5fn")
}

[sub_resource type="CylinderShape3D" id="CylinderShape3D_1o4ia"]
height = 0.103516
radius = 0.236816

[sub_resource type="CylinderShape3D" id="CylinderShape3D_xs5fn"]
height = 0.0947266
radius = 0.236816

[node name="Projectile" node_paths=PackedStringArray("hit_box", "movement", "on_hit") instance=ExtResource("1_r6l80")]
collision_mask = 0
damage = 0.1
lifetime = 1.5
hit_box = NodePath("Hitbox")
movement = [NodePath("MovementStrategies/SpeedProjectileMovementStrategy")]
on_hit = [NodePath("EventStrategies/OnHit/SpawnEntitiesEventStrategy")]

[node name="SpeedProjectileMovementStrategy" type="Node" parent="MovementStrategies" index="0"]
script = ExtResource("2_w3pkm")
speed = SubResource("Curve_vnuuy")
metadata/_custom_type_script = "uid://c1k2fcc6tpf3l"

[node name="SpawnEntitiesEventStrategy" type="Node" parent="EventStrategies/OnHit" index="0"]
script = ExtResource("4_4t18b")
metadata/_custom_type_script = "uid://cpx1eq3gu268a"

[node name="EntitySpawner" type="Node3D" parent="EventStrategies/OnHit/SpawnEntitiesEventStrategy" index="0"]
script = ExtResource("5_as7w8")
entity_to_spawn = ExtResource("6_aco2d")
time_between_entities = 0.4
offset_distance = 0.1
metadata/_custom_type_script = "uid://1e84fd3xrrff"

[node name="MeshInstance3D" type="MeshInstance3D" parent="." index="2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.242552, 0)
mesh = SubResource("CylinderMesh_1o4ia")

[node name="AnimationPlayer" type="AnimationPlayer" parent="." index="3"]
libraries = {
&"": SubResource("AnimationLibrary_4t18b")
}
autoplay = "rotate"

[node name="CollisionShape3D" type="CollisionShape3D" parent="." index="4"]
transform = Transform3D(-4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 0, 0, 1, 0, 0.240883, 0)
shape = SubResource("CylinderShape3D_1o4ia")
debug_color = Color(0, 0.647006, 0.222697, 0.42)

[node name="Hitbox" parent="." index="5" instance=ExtResource("4_1o4ia")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.243274, 0)
collision_layer = 4
collision_mask = 64
damage = 1.0
damage_cooldown = 0.01
attached_to = 3
can_hit = 7

[node name="CollisionShape3D" type="CollisionShape3D" parent="Hitbox" index="0"]
transform = Transform3D(-4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 0, 0, 1, 0, 0, 0)
shape = SubResource("CylinderShape3D_xs5fn")
