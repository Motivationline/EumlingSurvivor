[gd_scene load_steps=45 format=3 uid="uid://cvbt5bpffucle"]

[ext_resource type="PackedScene" uid="uid://by41qcd1ukb23" path="res://assets/characters/enemies/bossbugger/BossBugger.glb" id="1_kivi1"]
[ext_resource type="Shader" uid="uid://5x2ftmf5e728" path="res://game/shared/lquid_shader/liquid_shader.gdshader" id="2_lvjto"]
[ext_resource type="Script" uid="uid://pxwowh6vn2b7" path="res://assets/characters/enemies/bossbugger/liquid_wobble.gd" id="3_vkxpk"]
[ext_resource type="Texture2D" uid="uid://dvtouo6w5iri0" path="res://assets/characters/enemies/bossbugger/wings.png" id="4_djlvw"]
[ext_resource type="PackedScene" uid="uid://cy2tlb6wedycd" path="res://game/sound/base_logic/sfx/manager/sound_effect_manager.tscn" id="5_276u1"]
[ext_resource type="Script" uid="uid://bb6m3hglcrhmq" path="res://game/hitbox/hitbox.gd" id="5_url60"]
[ext_resource type="AudioStream" uid="uid://yfbah4eqpc3c" path="res://game/sound/sfx_assets/enemies/mosquito/refill_1.wav" id="6_w2jyf"]
[ext_resource type="AudioStream" uid="uid://baem7nyjyb463" path="res://game/sound/sfx_assets/enemies/mosquito/refill_2.wav" id="7_utr2x"]
[ext_resource type="AudioStream" uid="uid://dq2kt14kgyak3" path="res://game/sound/sfx_assets/enemies/mosquito/refill_3.wav" id="8_0bbqg"]
[ext_resource type="AudioStream" uid="uid://dmr8jjwqajdw3" path="res://game/sound/sfx_assets/enemies/mosquito/refill_4.wav" id="9_7g0vg"]
[ext_resource type="AudioStream" uid="uid://dux3und2jd6jl" path="res://game/sound/sfx_assets/enemies/mosquito/refill_5.wav" id="10_tgbpk"]
[ext_resource type="AudioStream" uid="uid://b43ty5yydh5s3" path="res://game/sound/sfx_assets/enemies/mosquito/shoot_1.wav" id="11_kdtju"]
[ext_resource type="AudioStream" uid="uid://85lbbm1tebtw" path="res://game/sound/sfx_assets/enemies/mosquito/shoot_2.wav" id="12_q0d2i"]
[ext_resource type="AudioStream" uid="uid://c4r8fr1tuitx8" path="res://game/sound/sfx_assets/enemies/mosquito/shoot_3.wav" id="13_blvml"]
[ext_resource type="AudioStream" uid="uid://dsqqvtwgxaig8" path="res://game/sound/sfx_assets/enemies/mosquito/shoot_4.wav" id="14_q476s"]
[ext_resource type="AudioStream" uid="uid://cpxaljlk8w8d" path="res://game/sound/sfx_assets/enemies/mosquito/shoot_5.wav" id="15_e4fgu"]
[ext_resource type="AudioStream" uid="uid://q2wkde13g76u" path="res://game/sound/sfx_assets/enemies/mosquito/shoot_6.wav" id="16_a13vd"]

[sub_resource type="GDScript" id="GDScript_djlvw"]
script/source = "extends Node3D
@onready var mesh_instance_3d: MeshInstance3D = $Armature_001/Skeleton3D/BoneAttachment3D/MeshInstance3D

const FLUID_MIN: float = -0.45
const FLUID_MAX: float = 0.45

@export var fluid_level: float = 0.0:
	set(value):
		fluid_level = clampf(value, 0, 1)
		mesh_instance_3d.liquid_height = FLUID_MIN + fluid_level * (FLUID_MAX - FLUID_MIN)
"

[sub_resource type="Gradient" id="Gradient_vkxpk"]
colors = PackedColorArray(0.3272901, 0.11730001, 0.69, 1, 0.75333357, 0.26, 1, 1)

[sub_resource type="GradientTexture1D" id="GradientTexture1D_djlvw"]
gradient = SubResource("Gradient_vkxpk")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_url60"]
render_priority = 0
shader = ExtResource("2_lvjto")
shader_parameter/liquid_height = -0.488
shader_parameter/liquid_surface_color = Color(0.8693332, 0.44, 1, 1)
shader_parameter/liquid_rim_gradient = SubResource("GradientTexture1D_djlvw")
shader_parameter/rim_emission_intensity = 0.814000038665
shader_parameter/rim_exponent = 3.0
shader_parameter/emission_intensity = 0.1
shader_parameter/liquid_surface_gradient_size = 0.1
shader_parameter/wobble = Vector2(7.7976335e-38, -1.4237615e-37)

[sub_resource type="SphereMesh" id="SphereMesh_vkxpk"]
radius = 0.6

[sub_resource type="AtlasTexture" id="AtlasTexture_url60"]
atlas = ExtResource("4_djlvw")
region = Rect2(0, 0, 128, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_tuq3u"]
atlas = ExtResource("4_djlvw")
region = Rect2(128, 0, 128, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_r72m3"]
atlas = ExtResource("4_djlvw")
region = Rect2(256, 0, 128, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_ir37v"]
atlas = ExtResource("4_djlvw")
region = Rect2(0, 64, 128, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_w4i13"]
atlas = ExtResource("4_djlvw")
region = Rect2(128, 64, 128, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_gch53"]
atlas = ExtResource("4_djlvw")
region = Rect2(256, 64, 128, 64)

[sub_resource type="SpriteFrames" id="SpriteFrames_dfjp2"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_url60")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_tuq3u")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_r72m3")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_ir37v")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_w4i13")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_gch53")
}],
"loop": true,
"name": &"wings",
"speed": 30.0
}]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_vkxpk"]
animation = &"idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_djlvw"]
animation = &"refill"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_url60"]
animation = &"shoot"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_tuq3u"]
animation = &"slash"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_djlvw"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_url60"]
xfade_time = 0.15
advance_mode = 2
advance_condition = &"REFILL"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_tuq3u"]
xfade_time = 0.5
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_r72m3"]
xfade_time = 0.1
advance_mode = 2
advance_condition = &"idle"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ir37v"]
xfade_time = 0.1
advance_mode = 2
advance_condition = &"shoot"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_w4i13"]
xfade_time = 0.1
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_gch53"]
xfade_time = 0.1
advance_mode = 2
advance_condition = &"melee"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_url60"]
states/Start/position = Vector2(212, 100)
states/idle/node = SubResource("AnimationNodeAnimation_vkxpk")
states/idle/position = Vector2(407, 101)
states/refill/node = SubResource("AnimationNodeAnimation_djlvw")
states/refill/position = Vector2(407, 242)
states/shoot/node = SubResource("AnimationNodeAnimation_url60")
states/shoot/position = Vector2(551, 21)
states/slash/node = SubResource("AnimationNodeAnimation_tuq3u")
states/slash/position = Vector2(532, 150)
transitions = ["Start", "idle", SubResource("AnimationNodeStateMachineTransition_djlvw"), "idle", "refill", SubResource("AnimationNodeStateMachineTransition_url60"), "refill", "idle", SubResource("AnimationNodeStateMachineTransition_tuq3u"), "shoot", "idle", SubResource("AnimationNodeStateMachineTransition_r72m3"), "idle", "shoot", SubResource("AnimationNodeStateMachineTransition_ir37v"), "slash", "idle", SubResource("AnimationNodeStateMachineTransition_w4i13"), "idle", "slash", SubResource("AnimationNodeStateMachineTransition_gch53")]
graph_offset = Vector2(80, 40)

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_3cixo"]
playback_mode = 1
random_pitch = 1.3
random_volume_offset_db = 1.0
streams_count = 5
stream_0/stream = ExtResource("6_w2jyf")
stream_1/stream = ExtResource("7_utr2x")
stream_2/stream = ExtResource("8_0bbqg")
stream_3/stream = ExtResource("9_7g0vg")
stream_4/stream = ExtResource("10_tgbpk")

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_cxkkn"]
playback_mode = 1
random_pitch = 1.3
random_volume_offset_db = 1.0
streams_count = 6
stream_0/stream = ExtResource("11_kdtju")
stream_1/stream = ExtResource("12_q0d2i")
stream_2/stream = ExtResource("13_blvml")
stream_3/stream = ExtResource("14_q476s")
stream_4/stream = ExtResource("15_e4fgu")
stream_5/stream = ExtResource("16_a13vd")

[sub_resource type="BoxShape3D" id="BoxShape3D_tuq3u"]
size = Vector3(1.2182722, 1.1872559, 1.8353877)

[node name="BossBugger" instance=ExtResource("1_kivi1")]
script = SubResource("GDScript_djlvw")

[node name="Skeleton3D" parent="Armature_001" index="0"]
bones/0/position = Vector3(0, 1.4046468, -2.7885516e-22)
bones/0/rotation = Quaternion(0.8441082, 2.4500737e-08, -3.8572015e-08, -0.53617287)
bones/1/rotation = Quaternion(1, 8.881785e-16, -7.54979e-08, -2.7219642e-22)
bones/1/scale = Vector3(0.99999994, 1.0000001, 1)
bones/4/rotation = Quaternion(0.12208321, 4.5353772e-08, -5.578661e-09, 0.9925199)
bones/5/rotation = Quaternion(0.08913603, 2.530731e-14, 3.0796363e-14, 0.9960195)
bones/6/rotation = Quaternion(-6.7893416e-07, -2.4498158e-14, -9.606624e-15, 1)
bones/6/scale = Vector3(0.99999976, 1.0000004, 0.9999998)
bones/7/rotation = Quaternion(7.255003e-07, -3.6085518e-15, 9.606601e-15, 1)
bones/7/scale = Vector3(1, 1.0000001, 0.99999994)
bones/8/rotation = Quaternion(-6.5751374e-07, 6.352747e-22, -8.791276e-21, 1)
bones/8/scale = Vector3(1, 0.9999999, 1)
bones/9/rotation = Quaternion(7.8231096e-08, 8.999725e-22, 5.032567e-21, 1)
bones/10/rotation = Quaternion(-1.5506527e-07, -5.2939534e-22, 2.5592975e-20, 1)
bones/10/scale = Vector3(1.0000006, 0.9999988, 1.0000005)
bones/11/rotation = Quaternion(7.692722e-07, -3.7057712e-22, -5.528544e-20, 1)
bones/11/scale = Vector3(0.9999994, 1.0000012, 0.9999994)
bones/12/rotation = Quaternion(-7.2130933e-07, 6.418922e-20, 1.0341009e-13, 1)
bones/12/scale = Vector3(0.99999994, 1.0000002, 0.99999994)
bones/13/rotation = Quaternion(2.705493e-07, 3.7215265e-15, -1.0829064e-13, 1)
bones/13/scale = Vector3(1.0000005, 0.99999905, 1.0000004)
bones/14/rotation = Quaternion(-3.436579e-07, -3.719802e-15, 4.880548e-15, 1)
bones/14/scale = Vector3(0.9999993, 1.0000014, 0.9999994)
bones/15/rotation = Quaternion(4.0512538e-07, -2.3822794e-22, 7.239817e-20, 1)
bones/15/scale = Vector3(1.0000004, 0.9999993, 1.0000004)
bones/16/rotation = Quaternion(-2.2910537e-07, -4.7645603e-22, -2.5652527e-20, 1)
bones/16/scale = Vector3(1, 0.9999999, 1)
bones/17/rotation = Quaternion(-0.23471725, -0.0022186695, 0.0027666413, 0.9720572)
bones/18/rotation = Quaternion(-0.36086822, 0.32378197, 0.014052461, 0.87449527)
bones/19/rotation = Quaternion(-0.14799444, 0.15971757, -0.7159135, -0.6633671)
bones/22/rotation = Quaternion(-0.11242238, 0.18647599, -0.83585465, -0.50391954)
bones/25/rotation = Quaternion(-0.23471716, 0.002218758, -0.0027666187, 0.9720572)
bones/26/rotation = Quaternion(-0.36086825, -0.32378185, -0.014052411, 0.87449527)
bones/27/position = Vector3(-0.08559792, 0.16990669, -0.084129386)
bones/27/rotation = Quaternion(-0.1174677, -0.42174497, 0.60000384, 0.66957295)
bones/27/scale = Vector3(1, 0.9999999, 0.99999994)
bones/28/rotation = Quaternion(0.031377904, 0.6281272, -0.043345843, 0.77626854)
bones/29/rotation = Quaternion(0.35895163, -0.015417091, 0.03462342, 0.9325863)
bones/30/rotation = Quaternion(-0.011062861, 0.88252, -0.4687451, 0.036250263)
bones/31/rotation = Quaternion(0.14799431, 0.15971762, -0.7159135, 0.66336703)
bones/34/rotation = Quaternion(0.1124223, 0.18647604, -0.83585477, 0.50391954)

[node name="BoneAttachment3D" type="BoneAttachment3D" parent="Armature_001/Skeleton3D" index="0"]
transform = Transform3D(0.99999994, -8.881785e-15, 2.3841854e-07, 2.1581073e-07, 0.4250374, -0.90517586, -1.0133678e-07, 0.9051759, 0.42503738, 2.4104869e-17, 1.4034932, -0.002456574)
bone_name = "DEF_FLUID"
bone_idx = 2

[node name="MeshInstance3D" type="MeshInstance3D" parent="Armature_001/Skeleton3D/BoneAttachment3D" index="0"]
transform = Transform3D(1, -6.208427e-08, 8.1328295e-09, 6.183289e-08, 0.95868754, -0.28446186, 9.863726e-09, 0.28446168, 0.95868754, 7.614165e-09, 0.5802684, -0.009195534)
material_override = SubResource("ShaderMaterial_url60")
mesh = SubResource("SphereMesh_vkxpk")
script = ExtResource("3_vkxpk")
liquid_height = -0.488

[node name="backwings" parent="Armature_001/Skeleton3D" index="1"]
visible = false

[node name="frontwings" parent="Armature_001/Skeleton3D" index="14"]
visible = false

[node name="HullInside" parent="Armature_001/Skeleton3D" index="15"]
visible = false

[node name="BoneAttachment3D2" type="BoneAttachment3D" parent="Armature_001/Skeleton3D" index="16"]
transform = Transform3D(-0.076083705, -0.99710166, -4.1055063e-07, -2.0861626e-07, -3.3527613e-07, 1, -0.99710166, 0.07608373, -1.7881393e-07, -0.24529767, 1.4060749, -0.0006708463)
bone_name = "DEF_FRONTWING.L"
bone_idx = 19

[node name="AnimatedSprite3D" type="AnimatedSprite3D" parent="Armature_001/Skeleton3D/BoneAttachment3D2" index="0"]
transform = Transform3D(0.1124437, -0.86069745, 0.49654457, 0.99343705, 0.10792635, -0.037889056, -0.020979252, 0.4975459, 0.8671841, 0.062692575, 0.8214551, 0.17844987)
sprite_frames = SubResource("SpriteFrames_dfjp2")
animation = &"wings"
autoplay = "wings"
frame_progress = 0.7738692

[node name="BoneAttachment3D3" type="BoneAttachment3D" parent="Armature_001/Skeleton3D" index="17"]
transform = Transform3D(-0.46685255, -0.88433516, -3.5094598e-07, -1.7881393e-07, -3.1292439e-07, 1, -0.8843351, 0.46685266, -2.9802322e-08, -0.13967305, 1.2617724, -0.023997016)
bone_name = "DEF_BACKWING.L"
bone_idx = 22

[node name="AnimatedSprite3D" type="AnimatedSprite3D" parent="Armature_001/Skeleton3D/BoneAttachment3D3" index="0"]
transform = Transform3D(0.112443715, -0.86069757, 0.4965446, 0.9934372, 0.1079264, -0.03788905, -0.020979252, 0.4975459, 0.86718404, 0.085815355, 0.9607185, 0.17260218)
sprite_frames = SubResource("SpriteFrames_dfjp2")
animation = &"wings"
autoplay = "wings"
frame_progress = 0.7801252

[node name="BoneAttachment3D4" type="BoneAttachment3D" parent="Armature_001/Skeleton3D" index="18"]
transform = Transform3D(-0.07608363, 0.9971016, 4.835191e-07, 2.9802322e-07, -4.5262277e-07, 1.0000002, 0.99710155, 0.07608366, -2.682209e-07, 0.24529767, 1.4060749, -0.00067084626)
bone_name = "DEF_FRONTWING.R"
bone_idx = 31

[node name="AnimatedSprite3D" type="AnimatedSprite3D" parent="Armature_001/Skeleton3D/BoneAttachment3D4" index="0"]
transform = Transform3D(-0.17642894, 0.91023165, 0.37463757, 0.9834348, 0.14691877, 0.10617274, 0.041600414, 0.38716334, -0.92107224, -0.10956442, 0.7491533, 0.208817)
sprite_frames = SubResource("SpriteFrames_dfjp2")
animation = &"wings"
autoplay = "wings"
frame_progress = 0.26568833

[node name="BoneAttachment3D5" type="BoneAttachment3D" parent="Armature_001/Skeleton3D" index="19"]
transform = Transform3D(-0.4668526, 0.88433516, 3.1960624e-07, 2.3841858e-07, -2.8312206e-07, 1, 0.88433504, 0.46685272, -1.1920929e-07, 0.13967305, 1.2617723, -0.02399702)
bone_name = "DEF_BACKWING.R"
bone_idx = 34

[node name="AnimatedSprite3D" type="AnimatedSprite3D" parent="Armature_001/Skeleton3D/BoneAttachment3D5" index="0"]
transform = Transform3D(0.02324143, 0.9017, 0.43173987, 0.99260414, 0.030659795, -0.11746749, -0.11915756, 0.43127665, -0.89431685, 0.032096498, 0.8236661, 0.119693875)
sprite_frames = SubResource("SpriteFrames_dfjp2")
animation = &"wings"
autoplay = "wings"
frame_progress = 0.36893052

[node name="AnimationTree" type="AnimationTree" parent="." index="2"]
tree_root = SubResource("AnimationNodeStateMachine_url60")
anim_player = NodePath("../AnimationPlayer")
parameters/conditions/REFILL = false
parameters/conditions/idle = false
parameters/conditions/melee = false
parameters/conditions/shoot = false

[node name="SoundEffectManager" parent="." index="3" instance=ExtResource("5_276u1")]

[node name="Refill" type="AudioStreamPlayer3D" parent="SoundEffectManager" index="1"]
stream = SubResource("AudioStreamRandomizer_3cixo")
volume_db = -8.0
unit_size = 15.0
panning_strength = 2.0
bus = &"SFXEnemies"
attenuation_filter_cutoff_hz = 20500.0

[node name="Shoot" type="AudioStreamPlayer3D" parent="SoundEffectManager" index="2"]
stream = SubResource("AudioStreamRandomizer_cxkkn")
volume_db = -8.0
unit_size = 15.0
max_polyphony = 5
panning_strength = 2.0
bus = &"SFXEnemies"
attenuation_filter_cutoff_hz = 20500.0

[node name="HitBox" type="Area3D" parent="." index="4"]
collision_layer = 33
collision_mask = 9
script = ExtResource("5_url60")
damage = 2.0
attached_to = 6
can_hit = 4
metadata/_custom_type_script = "uid://bb6m3hglcrhmq"

[node name="CollisionShape3D" type="CollisionShape3D" parent="HitBox" index="0"]
shape = SubResource("BoxShape3D_tuq3u")
debug_color = Color(13.1910305, 0, 0, 1)
